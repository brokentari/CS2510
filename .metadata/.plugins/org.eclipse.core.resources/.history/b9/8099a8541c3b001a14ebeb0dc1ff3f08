import tester.Tester;

interface ILoItems {
  int getItemsSize();
  int getItemsSizeRestrictd();
  int getItemsLength();
  String getItemsImgNames();
}

interface Item {
  int getSize();
  int getLength();
  String getImgName();
}

class WebPage {
  String title;
  String url;
  ILoItems items;
  
  WebPage(String title, String url, ILoItems items) {
    this.title = title;
    this.url = url;
    this.items = items;
  }
  
  int getTotalImgSize() {
    return items.getItemsSize();
  }
  
  int getRestrictedImgSize() {
    return items.getItemsSizeRestrictd();
  }
  
  int textLength() {
    return this.title.replaceAll("\\W", "").length() + 
        this.items.getItemsLength();
  }
  
  String images() {
    return this.items.getItemsImgNames();
  }
}

class Text implements Item {
  String contents;
  
  Text(String contents) {
    this.contents = contents;
  }

  @Override
  public int getSize() {
    // TODO Auto-generated method stub
    return 0;
  }

  @Override
  public int getLength() {
    // TODO Auto-generated method stub
    return this.contents.replaceAll("\\W", "").length();
  }

  @Override
  public String getImgName() {
    // TODO Auto-generated method stub
    return "";
  }
}

class Image implements Item {
  String fileName;
  int size;
  String fileType;
  
  Image(String fileName, int size, String fileType) {
    this.fileName = fileName;
    this.size = size;
    this.fileType = fileType;
  }

  @Override
  public int getSize() {
    // TODO Auto-generated method stub
    return this.size;
  }

  @Override
  public int getLength() {
    // TODO Auto-generated method stub
    return this.fileName.replaceAll("\\W", "").length()
        + this.fileType.length();
  }

  @Override
  public String getImgName() {
    // TODO Auto-generated method stub
    return fileName + "." + fileType;
  }
}

class Link implements Item {
  String name;
  WebPage page;
  
  Link(String name, WebPage page) {
    this.name = name;
    this.page = page;
  }

  @Override
  public int getSize() {
    // TODO Auto-generated method stub
    return this.page.getRestrictedImgSize();
  }

  @Override
  public int getLength() {
    // TODO Auto-generated method stub
    return this.name.replaceAll("\\s", "").length();
  }

  @Override
  public String getImgName() {
    // TODO Auto-generated method stub
    return this.page.images();
  }
}

class MtLoItem implements ILoItems {
  MtLoItem() { }

  @Override
  public int getItemsSize() {
    // TODO Auto-generated method stub
    return 0;
  }

  @Override
  public int getItemsSizeRestrictd() {
    // TODO Auto-generated method stub
    return 0;
  }

  @Override
  public int getItemsLength() {
    // TODO Auto-generated method stub
    return 0;
  }

  @Override
  public String getItemsImgNames() {
    // TODO Auto-generated method stub
    return "";
  }
}

class ConsLoItem implements ILoItems {
  Item first;
  ILoItems rest;
  
   ConsLoItem(Item first, ILoItems rest) {
     this.first = first;
     this.rest = rest;
   }
   
   public int getItemsSizeRestrictd() {
     if (this.first.getClass().isInstance(new Link("", null))) {
        return this.first.getSize();
      } else {
        return this.first.getSize() + this.rest.getItemsSizeRestrictd();
      }
    }
   
  @Override
  public int getItemsSize() {
    // TODO Auto-generated method stub
    return this.first.getSize() + this.rest.getItemsSizeRestrictd();
  }

  @Override
  public int getItemsLength() {
    // TODO Auto-generated method stub
    return this.first.getLength() + this.rest.getItemsLength();
  }

  @Override
  public String getItemsImgNames() {
    // TODO Auto-generated method stub
      return this.first.getImgName() + ", " + this.rest.getItemsImgNames();
  }
}


class ExamplesWebPage {
  ILoItems emptyItem = new MtLoItem();
  
  // HtDP webapge
  Item htdpText = new Text("How to Design Programs");
  Item htdpImg = new Image("htdp", 4300, "tiff");
  ILoItems htdpItems = new ConsLoItem(htdpText, new ConsLoItem(htdpImg, emptyItem));
  WebPage htdpPage = new WebPage("HtDP", "htdp.org", htdpItems);
  
  // OOD webpage
  Item oodText = new Text("Stay classy, Java");
  Item oodLink = new Link("Back to the Future", htdpPage);
  ILoItems oodItems = new ConsLoItem(oodText, new ConsLoItem(oodLink, emptyItem));
  WebPage oodPage = new WebPage("OOD","ccs.neu.edu/OOD", oodItems);
  
  // Fundies II webpage
  Item fundiesTextOne = new Text("Home sweet home");
  Item fundiesTextTwo = new Text("The staff");
  Item fundiesImgOne = new Image("wvh-lab", 400, "png");
  Item fundiesImgTwo = new Image("profs", 240, "jpeg");
  Item fundiesLinkOne = new Link("A Look Back", htdpPage);
  Item fundiesLinkTwo = new Link("A Look Ahead", oodPage);
  ILoItems fundiesItems = new ConsLoItem(fundiesTextOne, 
      (new ConsLoItem(fundiesTextTwo, 
          new ConsLoItem(fundiesImgOne,
              new ConsLoItem(fundiesImgTwo, 
                  new ConsLoItem(fundiesLinkOne,
                      new ConsLoItem(fundiesLinkTwo, emptyItem)))))));
  WebPage fundiesWP = new WebPage("Fundies II", "ccs.neu.edu/Fundies2", fundiesItems);
  
  // Tests
  boolean testImgSize(Tester t) {
    return t.checkExpect(oodPage.getTotalImgSize(), 4300) &&
        t.checkExpect(htdpPage.getTotalImgSize(), 4300) &&
        t.checkExpect(fundiesWP.getTotalImgSize(), 4940);
  }
  
  boolean testLength(Tester t) {
    return t.checkExpect(htdpPage.textLength(), 31) &&
        t.checkExpect(oodPage.textLength(), 32) &&
        t.checkExpect(fundiesWP.textLength(), 67);
  }
  
  boolean testImgNames(Tester t) {
    return t.checkExpect(htdpPage.images(), "htdp.tiff");
  }
}
